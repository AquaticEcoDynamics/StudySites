!-------------------------------------------------------------------------------
! aed
!-------------------------------------------------------------------------------
!
! solution_method (1: Euler's Method)
! link_bottom_drag (T/F: AED variables included/excluded in TFV bottom drag)
! link_surface_drag (T/F: AED variables included/excluded in TFV surface drag)
! link_water_density (T/F: AED variables included/excluded in TFV density calculation)
! link_water_clarity (T/F: AED variables included/excluded in TFV light extinction)
! base_par_extinction (Kw; /m)
! ext_tss_extinction (T/F: TFV SS concs included/excluded in extinction coefficient calculation)
!
&aed2_bio
   solution_method = 1
   link_bottom_drag = .false.
   link_surface_drag = .false.
   link_water_density = .false.
   link_water_clarity = .true.
   base_par_extinction = 0.4
   ext_tss_extinction = .false.
   do_limiter = .true.
/

!-------------------------------------------------------------------------------
! aed2_nml
!-------------------------------------------------------------------------------
!
! List here the available aed2 modules to be included in the simulation.
! It is important they are listed in the correct order so dependecicies can be
! set during the model set-up phase.
!
! For further detail about available AED modules visit:
!     aed.see.uwa.edu.au/research/models/AED
!
!-------------------------------------------------------------------------------
&aed2_models
    models = !'aed2_sedflux',
              'aed2_tracer',
              'aed2_oxygen',
             !'aed2_carbon',
              'aed2_silica',
              'aed2_nitrogen',
              'aed2_phosphorus',
              'aed2_organic_matter',
              'aed2_phytoplankton',
             !'aed2_zooplankton',
             !'aed2_geochemistry',
             !'aed2_seddiagenesis',
			 !'aed2_macrophyte',
	         'aed2_totals'
/

!###############################################################################
! aed2_sedflux
!  sediment flux model types :
!       "Constant" = sedimentation fluxes are constant values.
!       "Constant2d" = Sedimentation fluxes may be different for
!                                different benthic cells - provided by driver
!       "Dynamic" = Sedimentation fluxes may be different for
!                                different benthic cells at different times
!                                        - computed by model
!       "Dynamic2d" = Sedimentation fluxes may be different for
!                                different benthic cells at different times
!                                        - computed by model
!-------------------------------------------------------------------------------
&aed2_sedflux
  !sedflux_model = 'Constant'
   sedflux_model = 'Spatially Variable'
/

!###############################################################################
! aed2_sed_<model>
!  Fsed_oxy  = Sedimentation flux for oxygen
!  Fsed_rsi  = Sedimentation flux for silica
!  Fsed_amm  = Sedimentation flux for ammonia
!  Fsed_nit  = Sedimentation flux for nitrogen
!  Fsed_frp  = Sedimentation flux for phosphorus
!  Fsed_pon  = Sedimentation flux for particulate organic nitrogen
!  Fsed_don  = Sedimentation flux for dissolved organic nitrogen
!  Fsed_pop  = Sedimentation flux for particulate organic phosphorus
!  Fsed_dop  = Sedimentation flux for dissolved organic phosphorus
!  Fsed_poc  = Sedimentation flux for particulate organic carbon
!  Fsed_doc  = Sedimentation flux for dissolved organic carbon
!  Fsed_dic  = Sedimentation flux for dissolved inorganic carbon
!  Fsed_ch4  = Sedimentation flux for methane
!  Fsed_feii = Sedimentation flux for iron
!-------------------------------------------------------------------------------
&aed2_sed_constant
   Fsed_oxy = -50.0
   Fsed_rsi = -9999
   Fsed_amm = -9999
   Fsed_nit = -9999
   Fsed_frp = -9999
   Fsed_pon = -9999
   Fsed_don = -9999
   Fsed_pop = -9999
   Fsed_dop = -9999
   Fsed_poc = -9999
   Fsed_doc = -9999
   Fsed_dic = -9999
/
&aed2_sed_const2d
   n_zones = 3
   !-- disable these being allocated by using "-1e10"
   Fsed_oxy = -35.0,-50.0,-80.0
   Fsed_rsi = -1e10,-1e10,-1e10
   Fsed_amm = -1e10,-1e10,-1e10
   Fsed_nit = -1e10,-1e10,-1e10
   Fsed_frp = 0.2,0.2,0.2
   Fsed_pon = -1e10,-1e10,-1e10
   Fsed_don = -1e10,-1e10,-1e10
   Fsed_pop = -1e10,-1e10,-1e10
   Fsed_dop = -1e10,-1e10,-1e10
   Fsed_poc = -1e10,-1e10,-1e10
   Fsed_doc = -1e10,-1e10,-1e10
   Fsed_dic = -1e10,-1e10,-1e10
/

!-------------------------------------------------------------------------------
!###############################################################################
! aed2_tracer
!   num_tracers = number of tracers to model
!   decay       = list of decay rates for the tracers
!   settling    = list of settling rates for the tracers
!   fsed        = list of sedimentation fluxes for the tracers
!-------------------------------------------------------------------------------
&aed2_tracer
   retention_time = .true.
   num_tracers = 2
   decay = 0,0               !, 0, 0, ...
   settling = -0.03,-0.001  !, 0, 0, ....
   fsed = 0,0               !, 0, 0, ...
   Ke_ss = 0.06,0.063       !, 0.02, 0.02
   resuspension = 0.
   !epsilon = 0.02   !, 0.02, 0.02
   !tau_0 = 0.01     !, 0.01, 0.01
   !tau_r = 1.0      !, 1.0, 1.0
/

!-------------------------------------------------------------------------------
!###############################################################################
! aed2_oxygen - AED oxygen model
!-------------------------------------------------------------------------------
! oxy_initial   [float, unit = mmol/m^3]
!                 initial O2 concentration (can be overwritten by GLM or TFV IC)
! Fsed_oxy      [float, unit = mmol/m^2/day]
!                 sediment oxygen demand (unused if Fsed_oxy_variable is active)
! Ksed_oxy      [float, unit = mmol/m^3]
!                 half-saturation concentration of oxygen sediment flux
! theta_sed_oxy [float, unit = - ]
!                 Arrhenius temperature multiplier for sediment oxygen flux
!  Fsed_oxy_variable = Oxygen sedimentation variable link
!                         eg 'aed_sedflux_Fsed_oxy' will use the value supplied
!                          by the aed_sedflux model for Fsed_oxy
!
! NOTE: Processes such as photosynthesis and bacterial respiration from other
!       AED modules should be configured to use the following names:
!        aed_oxygen_oxy
!
! DIAGNOSTICS:
!
!-------------------------------------------------------------------------------
&aed2_oxygen
   oxy_initial = 225.0
   Fsed_oxy = -50.0     
   Ksed_oxy = 100.0
   theta_sed_oxy = 1.08
 ! Fsed_oxy_variable = 'SDF_Fsed_oxy'
   oxy_min = 0
   oxy_max = 500 
/

!-------------------------------------------------------------------------------
!###############################################################################
! aed_carbon - AED carbon model
!-------------------------------------------------------------------------------
! dic_initial   [float, unit = mmol/m^3]
!                 initial DIC concentration (can be overwritten by GLM or TFV IC)
! Fsed_dic      [float, unit = mmol/m^2/day]
!                 sediment CO2 flux
! Ksed_dic      [float, unit = mmol/m^3]
!                 half-saturation oxygen concentration controlling CO2 flux
! theta_sed_dic [float, unit = - ]
!                 Arrhenius temperature multiplier for sediment CO2 flux
! pH_initial    [float, unit = - ]
!                 initial water column pH
! atmco2        [float, unit = ppm]
!                 atmospheric CO2 concentration
! ionic         [float, unit = meq]
!                 average ionic strength of the water column
!
! ch4_initial   [float, unit = mmol/m^3]
!                 initial CH4 concentration (can be overwritten by GLM or TFV IC)
! Rch4ox        [float, unit = - ]
!                 maximum reaction rate of CH4 oxidation @ 20C
! Kch4ox        [float, unit = ppm]
!                 half-saturation oxygen concentration for CH4 oxidation
! vTch4ox       [float, unit = meq]
!                 Arrhenius temperature multiplier for CH4 oxidation
! Fsed_ch4      [float, unit = mmol/m^2/day]
!                 sediment CH4 flux
! Ksed_ch4      [float, unit = mmol/m^3]
!                 half-saturation oxygen concentration controlling CH4 flux
! theta_sed_ch4 [float, unit = - ]
!                 Arrhenius temperature multiplier for sediment CH4 flux
! methane_reactant_variable
!                 state variable to be consumed during CH4 oxidation
!
! NOTE: Processes such as photosynthesis and bacterial respiration from other
!       AED modules should be configured to use the following names:
!        aed_carbon_dic
!        aed_carbon_ch4
!        aed_carbon_pH
!
! DIAGNOSTICS:
!        -
!-------------------------------------------------------------------------------
&aed2_carbon
   !-- DIC and pH
   dic_initial = 1600.5
   Fsed_dic = 3.0
   Ksed_dic = 20.0
   theta_sed_dic = 1.08
   Fsed_dic_variable='Fsed_dic'
   pH_initial = 7.5
   atmco2 = 370e-6
   ionic = 0.1
   !-- CH4
   ch4_initial = 27.6
   Rch4ox = 0.01
   Kch4ox = 0.5
   vTch4ox = 1.08
   Fsed_ch4 = 0.5
   Ksed_ch4 = 100.0
   theta_sed_ch4 = 1.08
   methane_reactant_variable='OXY_oxy'
  !Fsed_ch4_variable='Fsed_ch4'
/

!-------------------------------------------------------------------------------
!###############################################################################
! aed2_silica
!  rsi_initial              = Initial silica value
!  Fsed_rsi                 = Sediment flux for silica
!  Ksed_rsi                 = Release rate for silica
!  theta_sed_rsi            = Temperature multiplier for silica flux
!  silica_reactant_variable = link for silica reactant variable
!  Fsed_rsi_variable        = silica flux variable link
!-------------------------------------------------------------------------------
&aed2_silica
   rsi_initial = 12.5
   Fsed_rsi = 1.8
   Ksed_rsi = 50.0
   theta_sed_rsi = 1.08
   silica_reactant_variable='OXY_oxy'
  !Fsed_rsi_variable = 'SDF_Fsed_rsi'
/

!-------------------------------------------------------------------------------
!###############################################################################
! aed2_nitrogen - AED nitrogen model
!-------------------------------------------------------------------------------
! amm_initial   [float, unit = mmol/m^3]
!                 initial NH4 concentration (can be overwritten by GLM or TFV IC)
! nit_initial   [float, unit = mmol/m^3]
!                 initial NO3 concentration (can be overwritten by GLM or TFV IC)
! Rnitrif        [float, unit = /day ]
!                 maximum reaction rate of nitrification @ 20C
! Rdenit        [float, unit = /day ]
!                 maximum reaction rate of denitrification @ 20C
! Fsed_amm      [float, unit = mmol/m^2/day]
!                 sediment NH4 flux
! Fsed_nit      [float, unit = mmol/m^2/day]
!                 sediment NH4 flux
! Knitrif        [float, unit = mmol/m^3 ]
!                 half-saturation oxygen concentration for CH4 oxidation
! Kdenit        [float, unit = mmol/m^3 ]
!                 half-saturation oxygen concentration for CH4 oxidation
! Ksed_amm      [float, unit = mmol/m^3]
!                 half-saturation oxygen concentration controlling NH4 flux
! Ksed_nit      [float, unit = mmol/m^3]
!                 half-saturation oxygen concentration controlling NO3 flux
! theta_nitrif  [float, unit = - ]
!                 Arrhenius temperature multiplier for nitrification
! theta_denit   [float, unit = - ]
!                 Arrhenius temperature multiplier for denitrification
! theta_sed_amm [float, unit = - ]
!                 Arrhenius temperature multiplier for sediment NH4 flux
! theta_sed_nit [float, unit = - ]
!                 Arrhenius temperature multiplier for sediment NO3 flux
! nitrif_reactant_variable
!                 state variable to be consumed during nitrification
! denit_product_variable
!                 state variable to be incremented from denitrification
!
! NOTE: Processes such as phytoplankton uptake and zooplankton excretion from
!       other AED modules should be configured to use the following names:
!        aed_nitrogen_nit
!        aed_nitrogen_amm
!
! DIAGNOSTICS:
!        aed_nitrogen_denit
!
!-------------------------------------------------------------------------------
&aed2_nitrogen
   amm_initial = 12.7, !average for 08-Sep-2009
   nit_initial = 23.5, !average for 08-Sep-2009
   Rnitrif = 0.1,
   Rdenit = 0.26,      !from WC denit rates
   Fsed_amm = 3.5,     !maximum measured by Keryn #BB
   Fsed_nit = -4.5,    !maximum measured by Keryn
   Knitrif = 78.1,
   Kdenit = 2.0,
   Ksed_amm = 25.0,
   Ksed_nit = 100.0,
   theta_nitrif = 1.08,
   theta_denit = 1.08,
   theta_sed_amm = 1.08,
   theta_sed_nit = 1.08,
   nitrif_reactant_variable='OXY_oxy',   
   denit_product_variable='', !'N20',
  !Fsed_amm_variable='Fsed_amm'
  !Fsed_nit_variable='Fsed_nit'
/

!-------------------------------------------------------------------------------
!###############################################################################
! aed2_phosphorus - AED phosphorus model
!-------------------------------------------------------------------------------
! frp_initial   [float, unit = mmol/m^3]
!                 initial PO4 concentration (can be overwritten by GLM or TFV IC)
! Fsed_frp      [float, unit = mmol/m^2/day]
!                 sediment PO4 flux
! Ksed_frp      [float, unit = mmol/m^3]
!                 half-saturation oxygen concentration controlling PO4 flux
! theta_sed_frp [float, unit = - ]
!                 Arrhenius temperature multiplier for sediment PO4 flux
! phosphorus_reactant_variable   [string]
!                 state variable linked to sediment release
! simPO4Adsorption               [bool]
!                 switch to enable PO4 adsorption/desorption model
! ads_use_external_tss           [bool]
!                 switch to set external environment variable as substrate
! po4sorption_target_variable    [string]
!                 variable PO4 will adsorb onto (if not ads_use_external_tss)
! PO4AdsorptionModel             [integer]
!                 sorption algorithm to use
! Kpo4p         [float, unit = ]
!                 sorption constant
! ads_use_pH    [bool]
!                 switch to enagge pH dependency in sorption algorithm
! Kadsratio     [float, unit = ]
!                 sorption constant
! Qmax          [float, unit = ]
!                 sorption constant
! w_po4ads      [float, unit = m/d]
!                 settling rate of adsorbed PO4
!
! NOTE: Processes such as PO4 uptake and bacterial mineralisation from other
!       AED modules should be configured to use the following names:
!        aed_phosphorus_frp
!        aed_phosphorus_frp_ads
!
! DIAGNOSTICS:
!        -
!
!-------------------------------------------------------------------------------
&aed2_phosphorus
   frp_initial = 0.29
   Fsed_frp = 0.2 ! #BB
   Ksed_frp = 50.0
   theta_sed_frp = 1.10
   phosphorus_reactant_variable ='OXY_oxy'
  !Fsed_frp_variable ='Fsed_frp'
   simPO4Adsorption = .true.
   ads_use_external_tss = .false.
   po4sorption_target_variable ='TRC_ss1'
   PO4AdsorptionModel = 1
   Kpo4p = 0.1
   ads_use_pH = .false.
   Kadsratio= 1.0
   Qmax = 1.0
   w_po4ads = -0.01   ! doesnt seem to work
/

!-------------------------------------------------------------------------------
!###############################################################################
! aed2_organic_matter - AED organic matter model
!-------------------------------------------------------------------------------
! pom_initial     [float, unit = mmol/m^3]
!                   initial PON conc (can be overwritten by GLM or TFV IC)
! dom_initial     [float, unit = mmol/m^3]
!                   initial DON conc (can be overwritten by GLM or TFV IC)
! w_pom           [float, unit = m/day]
!                   settling rate of detrital N pool
! Rpom_miner      [float, unit = /day ]
!                   hydrolysis/breakdown rate of detrital N pool @ 20C
! Rdom_miner      [float, unit = /day ]
!                   mineralisation rate of DON pool @ 20C
! Fsed_pom        [float, unit = mmol/m^2/day]
!                   sediment PON flux (note this is extra to sedimentation)
! Fsed_dom        [float, unit = mmol/m^2/day]
!                   sediment DON flux
! Kpom_miner      [float, unit = mmol/m^3 ]
!                   half-saturation oxygen concentration for PON breakdown
! Kdom_miner      [float, unit = mmol/m^3 ]
!                   half-saturation oxygen concentration for DON mineralisation
! Ksed_dom        [float, unit = mmol/m^3]
!                   half-saturation oxygen concentration controlling DON flux
! theta_pom_miner [float, unit = - ]
!                   Arrhenius temperature multiplier for PON breakdown
! theta_dom_miner [float, unit = - ]
!                   Arrhenius temperature multiplier for DON mineralisation
! theta_sed_dom   [float, unit = - ]
!                   Arrhenius temperature multiplier for sediment DON flux
! dom_miner_product_variable   [string]
!                   state variable to be product of DON mineralisation
! KeDOM           [float, unit = /m /(mmol C/m^3)]
!                   specific light attenuation coefificent for DOM
! KePOM           [float, unit = /m /(mmol C/m^3)]
!                   specific light attenuation coefificent for POM
! doc_miner_reactant_variable  [string]
!                   state variable to be linked to rate of DOC mineralisation
!
! NOTE: Generic use of POM/DOM in the above descriptions, use C/N/P below
!
! NOTE: Processes such as phyto or zoop excretion within any other
!       AED modules should be configured to use the following names:
!        aed_organic_matter_doc    aed_organic_matter_poc
!        aed_organic_matter_don    aed_organic_matter_pon
!        aed_organic_matter_dop    aed_organic_matter_pop
!
! DIAGNOSTICS:
!        -
!
!-------------------------------------------------------------------------------
&aed2_organic_matter
    !-- ORGANIC CARBON
   poc_initial = 78.5, !average for 08-Sep-2009
   doc_initial = 39.9, !average for 08-Sep-2009
   w_poc = -0.06,
   Rpoc_miner = 0.05,
   Rdoc_miner = 0.001,
   Fsed_poc = 0.0,
   Fsed_doc = 0.0,
   Kpoc_miner = 31.25,
   Kdoc_miner = 31.25,
   Ksed_doc = 4.5,
   theta_poc_miner = 1.08,
   theta_doc_miner = 1.08,
   theta_sed_doc = 1.08,
   KeDOM       = 0.000005
   KePOM       = 0.00096
   doc_miner_reactant_variable='OXY_oxy',   
   doc_miner_product_variable='',
   !-- ORGANIC NITROGEN
   pon_initial = 8.3, !average for 08-Sep-2009
   don_initial = 1.3, !average for 08-Sep-2009
   w_pon = -0.06,
   Rpon_miner = 0.05,
   Rdon_miner = 0.005,
   Fsed_pon = 0.0,
   Fsed_don = 0.00,
   Kpon_miner = 31.25,
   Kdon_miner = 31.25,
   Ksed_don = 4.5,
   theta_pon_miner = 1.08,
   theta_don_miner = 1.08,
   theta_sed_don = 1.08,
   don_miner_product_variable='NIT_amm',
   !-- ORGANIC PHOSPHORUS
   pop_initial = 8.3,
   dop_initial = 1.5,
   w_pop = -0.06,
   Rpop_miner = 0.05,
   Rdop_miner = 0.001,
   Fsed_pop = 0.00,
   Fsed_dop = 0.0,
   Kpop_miner = 31.25,
   Kdop_miner = 31.25,
   Ksed_dop = 4.5,
   theta_pop_miner = 1.08,
   theta_dop_miner = 1.08,
   theta_sed_dop = 1.08,
   !pop_miner_reactant_variable='',   
   dop_miner_product_variable='',
!  Fsed_pon_variable='Fsed_pon'
!  Fsed_don_variable='Fsed_don'
!  Fsed_pop_variable='Fsed_pop'
!  Fsed_dop_variable='Fsed_dop'
!  Fsed_poc_variable='Fsed_poc'
!  Fsed_doc_variable='Fsed_doc'
   !-- REFRACTORY ORGANIC MATTER
   simRPools    = .true.
   docr_initial = 350.00
   donr_initial = 13.0
   dopr_initial = 3.0
   cpom_initial = 100.00
   Rdocr_miner  = 0.00
   Rdonr_miner  = 0.00
   Rdopr_miner  = 0.00
   Rcpom_bdown  = 0.00
   w_cpom       = -0.01 ! -0.01
   X_cpom_n     = 0.005
   X_cpom_p     = 0.0001
   KeDOMR       = 0.10000    ! = 1 (assuming KeDOMR is applied to CDOM in /m)
   KeCPOM       = 0.00096    ! = 0.08 (/m)/(mg/L)  /83.3  (mmol/m3)/(mg/L)
   extra_diag   = .true.
   simphotolysis = .true. 
   photo_c = 0.75
/


!-------------------------------------------------------------------------------
!###############################################################################
! aed2_phytoplankton - AED phytoplankton model
!-------------------------------------------------------------------------------
! num_phytos      [integer]
!                   number of phytoplankton groups within this module to include
! num_phytos      [integer]
!                   list of ID's of groups in aed_phyto_pars.nml (len=num_phyto)
! X_excretion_target_variable  [string]
!                   state variable to receive C, N or P from excretion
! X_mortality_target_variable  [string]
!                   state variable to receive C, N or P from mortality
! X_uptake_target_variable  [string]
!                   state variable to be linked for C,N,P,Si or O2 uptake
!
! NOTE: Users must supply a valid "aed_phyto_pars.nml" file
!
!
! NOTE: Processes such as zoop grazing or turbidity calc within any other
!       AED modules should be configured to use the following names:
!        aed_phytoplankton_name        (where name is as defined in the nml)
!        aed_phytoplankton_name_IN     (internal nitrogen)
!        aed_phytoplankton_name_IP     (internal phosphorus)
!
! DIAGNOSTICS:
!        aed_phytoplankton_name_fI     (light limitation)
!        aed_phytoplankton_name_fT     (temp limitation)
!        aed_phytoplankton_name_fS     (salinity limitation)
!        aed_phytoplankton_name_fN     (nitrogen limitation)
!        aed_phytoplankton_name_fP     (phosphorus limitation)
!        aed_phytoplankton_name_fSi    (silica limitation)
!        aed_phytoplankton_tchla       (total module chlorophyll-a)
!        aed_phytoplankton_gpp         (total module gross primary productivity)
!
!-------------------------------------------------------------------------------
&aed2_phytoplankton
   num_phytos = 5
   the_phytos = 1,2,3,4,5
   p_excretion_target_variable='OGM_dop'
   n_excretion_target_variable='OGM_don'
   c_excretion_target_variable='OGM_doc'
   si_excretion_target_variable=''
   p_mortality_target_variable='OGM_pop'
   n_mortality_target_variable='OGM_pon'
   c_mortality_target_variable='OGM_poc'
   si_mortality_target_variable=''
   p1_uptake_target_variable='PHS_frp'
   n1_uptake_target_variable='NIT_nit'
   n2_uptake_target_variable='NIT_amm'
   si_uptake_target_variable='SIL_rsi'
   do_uptake_target_variable='OXY_oxy'
   c_uptake_target_variable=''
   extra_debug = .true.
   dbase = '../External/AED2/aed2_phyto_pars_008.nml'
/

!-------------------------------------------------------------------------------
!###############################################################################
! aed2_zooplankton - AED zooplankton model
!-------------------------------------------------------------------------------
! num_zoops      [integer]
!                   number of zooplankton groups within this module to include
! the_zoops      [integer]
!                   list of ID's of groups in aed_zoop_pars.nml (len=num_zoops)
! dX_target_variable  [string]
!                   state variable linked to provide/receive dissoved OM
! pX_target_variable  [string]
!                   state variable linked to provide/receive particulate OM
!
! NOTE: Users must supply a valid "aed_zoops_pars.nml" file
!
!
! NOTE: Processes such as zoop grazing or turbidity calc within any other
!       AED modules should be configured to use the following names:
!        aed_zooplankton_name        (where name is as defined in the nml)
!
! DIAGNOSTICS:
!       -
!
!-------------------------------------------------------------------------------
&aed2_zooplankton
   num_zoops = 1
   the_zoops = 1
   dn_target_variable='OGM_don'  ! dissolved nitrogen target variable
   pn_target_variable='OGM_pon'  ! particulate nitrogen target variable
   dp_target_variable='OGM_dop'  ! dissolved phosphorus target variable
   pp_target_variable='OGM_pop'  ! particulate phosphorus target variable
   dc_target_variable='OGM_doc'  ! dissolved carbon target variable
   pc_target_variable='OGM_poc'  ! particulate carbon target variable
/


!###############################################################################
! aed2_pathogens
!  num_pathogens = number of pathogens to model
!  the_pathogens = list of pathogens classes (referencing the pathogens database)
!-------------------------------------------------------------------------------
&aed2_pathogens
   num_pathogens = 1
   the_pathogens = 1 !,3,5
   ! NEED UPDATED VARS HERE
   num_ss = 0
/
!-------------------------------------------------------------------------------
!###############################################################################
! aed2_macrophyte - AED macrophyte model
!-------------------------------------------------------------------------------
&aed2_macrophyte
   num_mphy = 1
   the_mphy = 1
   n_zones  = 1 ! This was 1 #BB
   active_zones = 5
   dbase = '../External/AED2/aed_mphy_pars.nml'
/




!###############################################################################
! aed2_totals
!  TN_vars      = list of variable contributing to total nitrogen
!  TN_varscale  = scaling of TN variables contribution
!  TP_vars      = list of variable contributing to total phosphorus
!  TP_varscale  = scaling of TP variables contribution
!  TOC_vars     = list of variable contributing to total organic carbon
!  TOC_varscale = scaling of TOC variables contribution
!  TSS_vars     = list of variable contributing to total suspended solids
!  TSS_varscale = scaling of TSS variables contribution
!                 <vector same length as TSS names>
!-------------------------------------------------------------------------------
&aed2_totals
   outputLight  = .true.
   TN_vars      =  'NIT_nit','NIT_amm','OGM_don','OGM_pon','OGM_donr','OGM_cpom','PHY_grn','PHY_bga','PHY_dino','PHY_crypt','PHY_diatom'
   TN_varscale  =   1.0,      1.0,      1.0,       1.0,     1.0,       ,0.005     ,0.15     ,0.15     ,0.15       ,0.15       ,0.15
   !TKN_vars     =  'NIT_amm','OGM_don','OGM_pon','OGM_donr','PHY_grn'
   !TKN_varscale =   1.0,      1.0,       1.0,     1.0,       0.15
   TP_vars =  'PHS_frp',
              'PHS_frp_ads',
              'OGM_dop',
              'OGM_dopr',
              'OGM_pop',
              'OGM_cpom',
              'PHY_grn',
              'PHY_bga',
              'PHY_dino',
              'PHY_diatom',
              'PHY_crypt'
   TP_varscale = 1.0, 1.0, 1.0, 1.0, 1.0, 0.0001, 0.01, 0.01, 0.01, 0.01, 0.01
   TOC_vars = 'OGM_doc',
              'OGM_docr',
              'OGM_poc',
              'OGM_cpom',
              'PHY_grn',
              'PHY_bga',
              'PHY_dino',
              'PHY_diatom',
              'PHY_crypt'
   TOC_varscale = 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0
   TSS_vars = 'TRC_ss1',
              'TRC_ss2', 
              'OGM_cpom',
              'OGM_poc',
              'PHY_grn',
              'PHY_bga',
              'PHY_dino',
              'PHY_diatom',
              'PHY_crypt'
   TSS_varscale = 1.0, 1.0, 0.024, 0.024, 0.02, 0.02, 0.02, 0.02, 0.02
   Turb_vars ='TRC_ss1',
              'TRC_ss2', 
              'OGM_cpom',
              'OGM_poc',
              'PHY_grn',
              'PHY_bga',
              'PHY_dino',
              'PHY_diatom',
              'PHY_crypt'
   Turb_varscale = 0.33,0.30,0.001,0.001,0.001,0.001,0.001,0.001,0.001       
  ! Table 4 in science plan, with OGM and PHY vars converted from mmolC to gC) ;
/








!-------------------------------------------------------------------------------
! aed2_geochemistry
!-------------------------------------------------------------------------------
! speciation_dt     [integer]
!                     number of timesteps between calculations
! geochem_file      [string]
!                     data file with thermodynamic info for speciation calculations
! num_components    [integer]
!                     number of dissolved 'components' to be considered
! dis_components    [string]
!                     list of component names (must match those in the geochem_file)
! component_link    [string]
!                     name of any active variabiles to be used as a component (if present, else '')
! Fsed_gch          [float]
!                     sediment flux rate of dissolved components (mol/m2/day)
! num_mineral       [integer]
!                     number of particulate mineral phases to be included
! the_minerals      [string]
!                     list of mineral names (must match those in the geochem_file)
! mineral_link      [string]
!                     name of any active variables to be used as a mineral (if present, else '')
! w_gch             [float]
!                     sedimentation rate of chosen particulate phases (m/day)
!-------------------------------------------------------------------------------
&aed2_geochemistry
   speciation_dt  = 10
   geochem_file   = 'aed2_geochem_pars.dat'
   num_components = 5
   dis_components = 'DIC','Ca','PO4','FeIII','FeII'
   component_link = 'dic','','frp','',''
   Fsed_gch       = 0.,0.,0.,0.,0.
 ! dis_initial    = 0.,2.,0.,0.2,0.
   num_minerals   = 2
   the_minerals   = 'Calcite', 'FeOH3A'
   mineral_link   = '',''
   w_gch          = 0.,0.
 ! min_initial    = 0.01,0.01 
 ! speciesOutput  = 'CO2'
/



! -----------------------------------------------------------------------------!
!  AED Sediment Diagenesis model (CANDI-AED)
! -----------------------------------------------------------------------------!
!                                                                              !
!-- Sediment Physical Properties                                               !
!                                                                              !
! diagenesis%db0     ! (cm2/yr): surface (x=0) value of the biodiffusion       !
! diagenesis%imix    ! (0/1)   : bioturbation, 0=gaussian decrease 1=2-layer mode!
! diagenesis%xs      ! (cm)    : if imix=0: half depth for the gaussian mixing !
! diagenesis%x1      ! (cm)    : if imix=1: depth for start of db decrease     !
! diagenesis%x2      ! (cm)    : if imix=1: depth where db(x) is zero (x2 > x1)!
! diagenesis%irrig   ! (0/1)   : include bio-irrigation effects                !
! diagenesis%alpha0  ! (1/yr)  : coefficient of irrigation                     !
! diagenesis%xirrig  ! (cm)    : maximum depth of irrigation                   !
! diagenesis%ventflow! (cm/yr) : advective flux, + from below, - from top      !
! diagenesis%w00     ! (cm/yr) : sediment accumulation: burial vel as x->infinity!
! diagenesis%p0      ! (-)     : porosity at x=0                               !
! diagenesis%p00     ! (-)     : porosity at infinity                          !
! diagenesis%bp      ! (-)     : if p0<>p00, porosity depth-attenuation coef   !
! diagenesis%torteq  ! (1/2/3) : tortuosity calc: 1=archie, 2=burger, 3=weissberg!
! diagenesis%an      ! (-)     : porosity exponent for tortuosity calc (archies) !
! diagenesis%aa      ! (-)     : porosity exponent for tortuosity calc (burger)!
! diagenesis%ab      ! (-)     : porosity exponent for tortuosity calc (weissberg!
! diagenesis%xl      ! (cm)    : maximum depth for calculations                !
! diagenesis%maxnpts ! (#)     : number of vertical layers to be included      !
!                                                                              !
!-- Reaction Rates                                                             !
!                                                                              !
! diagenesis%docl2dic  ! (1/yr): Rate of Labile DOC consumption                !
! diagenesis%donl2din  ! (1/yr): Rate of Labile DON consumption                !
! diagenesis%dopl2dip  ! (1/yr): Rate of Labile DOP consumption                !
! diagenesis%pocl2docl ! (1/yr): Rate of Labile POC hydrolysis to DOCL         !
! diagenesis%ponl2donl ! (1/yr): Rate of Labile PON hydrolysis to DONL         !
! diagenesis%popl2dopl ! (1/yr): Rate of Labile POP hydrolysis to DOPL         !
! diagenesis%docr2docl ! (1/yr): Rate of Refrac DOC breakdown to DOCL          !
! diagenesis%donr2donl ! (1/yr): Rate of Refrac DON breakdown to DONL          !
! diagenesis%dopr2dopl ! (1/yr): Rate of Refrac DOP breakdown to DOPL          !
! diagenesis%pocr2docr ! (1/yr): Rate of Refrac POC breakdown to DOCR          !
! diagenesis%ponr2donr ! (1/yr): Rate of Refrac PON breakdown to DONR          !
! diagenesis%popr2dopr ! (1/yr): Rate of Refrac POP breakdown to DOPR          !
! diagenesis%pocvr2docr! (1/yr): Rate of Very Refrac POC breakdown to DOCR     !
! diagenesis%ponvr2donr! (1/yr): Rate of Very Refrac PON breakdown to DONR     !
! diagenesis%popvr2dopr! (1/yr): Rate of Very Refrac POP breakdown to DOPR     !
! diagenesis%kNH4OX    ! (1/mM/yr): Rate constant for NH4 oxidation by O2      !
! diagenesis%kTSNO3    ! (1/mM/yr): Rate constant for H2S oxid. by NO3         !
! diagenesis%kTSOX     ! (1/mM/yr): Rate constant for H2S oxidation by O2      !
! diagenesis%kMnOX     ! (1/mM/yr): Rate constant for MnII oxidation by O2     !
! diagenesis%kMnNO3    ! (1/mM/yr): Rate constant for MnII oxidation by NO3    !
! diagenesis%kFeOX     ! (1/mM/yr): Rate constant for FeII oxidation by O2     !
! diagenesis%kFeSOX    ! (1/mM/yr): Rate constant for FeS oxidation by O2      !
! diagenesis%kFeS2OX   ! (1/mM/yr): Rate constant for FeS2 oxidation by O2     !
! diagenesis%kMnAge    ! (1/mM/yr): Rate constant for MnO2(A) aging -> MnO2(B) !
! diagenesis%kFeAge    ! (1/mM/yr): Rate constant for FeOH(A) aging -> FeOH(B) !
! diagenesis%kFeNO3    ! (1/mM/yr): Rate constant for Fe oxidation by NO3      !
! diagenesis%kFeSMn    ! (1/mM/yr): Rate constant for FeS oxidation by MnO2    !
! diagenesis%kFeSFe    ! (1/mM/yr): Rate constant for FeS oxidation by Fe(OH)3 !
! diagenesis%kFeSppt   ! (1/mM/yr): Rate constant for FeS formation from Fe2+  !
! diagenesis%kTSFe     ! (1/mM/yr): Rate constant for H2S oxidation with Fe(OH)3    !
! diagenesis%kPyrite   ! (1/mM/yr): Rate constant for Pyrite formation from FeS!
! diagenesis%kMnFe     ! (1/mM/yr): Rate constant for FeII oxidation with MnO2 !
! diagenesis%kTSMn     ! (1/mM/yr): Rate constant for H2S oxidation with MnO2  !
! diagenesis%kCH4OX    ! (1/mM/yr): Rate constant for CH4 oxidation with O2    !
! diagenesis%kCH4SO4   ! (1/mM/yr): Rate constant for CH4 oxidation with SO4   !
! diagenesis%kSidppt   !       : Rate of Siderite (FeCO3) formation            !
! diagenesis%kRodppt   !       : Rate of Rhodchros (MnCO3) formation           !
! diagenesis%kCalppt   !       : Rate if Calcite (CaCO3) formation             !
! diagenesis%k(p)O2    ! (mM)  : Monod constant for O2 reduction               !
! diagenesis%k(p)NO3   ! (mM)  : Monod constant for NO3 reduction              !
! diagenesis%k(p)MnO2  ! (mM)  : Monod constant for MnO2 reduction             !
! diagenesis%k(p)FeOH  ! (mM)  : Monod constant for Fe(OH)3 reduction          !
! diagenesis%k(p)SO4   ! (mM)  : Monod constant for SO4 reduction              !
! diagenesis%kNH4Ads   ! (-)   : Adsorption constant for NH4                   !
! diagenesis%kPO4Ads   ! (-)   : Adsorption constant for PO4                   !
! diagenesis%X         !       : Metal to use for metal sulfide and POX/DOX    !
! diagenesis%Xmk       !       : Stoichiometry of X in MnO2, FeOH, FeS         !
! diagenesis%Xfl       !       : Stoichiometry of X in MnO2, FeOH, FeS         !
! diagenesis%Xfm       !       : Stoichiometry of X in MnO2, FeOH, FeS         !
! diagenesis%kXSppt    ! ( )   : Precipitation rate of metal sulfide           !
! diagenesis%rxn_mode  !       : 0 = kinetic only; 1 = kinetic with IAP/Ksp    !
!                                                                              !
!-- Initial & Boundary Conditions                                              !
!                                                                              !
! diagenesis%ibc2       ! (0/1/2/3):  0=CAEDYM,                                !
!                                     1=known conc,                            !
!                                     2=prescr flux (requires PartFluxes.dat)  !
!                                     3=fixed BW                               !
! diagenesis%ibbc       ! (0/1): 0=fixed conc, 1=zero gradient                 !
! diagenesis%strtSteady ! (0/1): Calculate a steady state for start conditions !
! diagenesis%fluxscale  !   (-): Scale diffusive flux bewtween sed & water     !
! diagenesis%POMVR      !   (-): frac by weight of Very Refractory Organic Matter!
! diagenesis%InitSedDepth  !   : Initial sediment depth within the sed domain (xl)
! diagenesis%OMInitMethodL !   : Init profile for POML (EX_I, LI_I, CO_I)      !
! diagenesis%OM_top, OM_cf !   : EX_I initialisation params                    !
! diagenesis%OMInitMethodR !   : Init profile for POMR (EX_I, LI_I, CO_I)      !
! diagenesis%OM_min,InMinDep ! : LI_I initialisation params                    !
! diagenesis%OutputUnits   !   : *.SED units: 0 = mM; 1 = mg/L                 !
!                                                                              !
!------------------------------------------------------------------------------!
&aed2_sed_candi
!-- Sediment Physical Properties --!
   diagenesis%db0       =  1.00
   diagenesis%imix      = 0
   diagenesis%xs        =  3.00
   diagenesis%x1        =  9.00
   diagenesis%x2        = 10.00
   diagenesis%irrg     =  0
   diagenesis%alpha0    =  5.00
   diagenesis%xirrig    =  3.00
   diagenesis%ventflow  =  0.00
   diagenesis%w00       =  0.1
   diagenesis%p0        =  0.95
   diagenesis%p00       =  0.71
   diagenesis%bp        =  0.22
   diagenesis%torteq    =  3
   diagenesis%an        =  2.14
   diagenesis%aa        =  3.79
   diagenesis%ab        =  2.02
   diagenesis%xl        = 100.00
   diagenesis%maxnpts   = 40
!-- Reaction Rates --!
   diagenesis%docl2dic  = 1000
   diagenesis%donl2din  = 1000
   diagenesis%dopl2dip  = 1000
   diagenesis%pocl2docl = 0.1
   diagenesis%ponl2donl = 0.1
   diagenesis%popl2dopl = 0.1
   diagenesis%docr2docl = 1000
   diagenesis%donr2donl = 1000
   diagenesis%dopr2dopl = 1000
   diagenesis%pocr2docr =  0.001
   diagenesis%ponr2donr =  0.001
   diagenesis%popr2dopr =  0.001
   diagenesis%pocvr2docr=  0.00001
   diagenesis%ponvr2donr=  0.00001
   diagenesis%popvr2dopr=  0.00001
   diagenesis%kNH4OX    =  2.00E+04
   diagenesis%kTSNO3    =  1.00E+04
   diagenesis%kTSOX     =  6.00E+05
   diagenesis%kMnOX     =  2.00E+06
   diagenesis%kMnNO3    =  1e+3
   diagenesis%kFeOX     =  2.00E+06
   diagenesis%kFeSOX    =  2.20E+04
   diagenesis%kFeS2OX   =  1e+4
   diagenesis%kMnAge    =  1e+2
   diagenesis%kFeAge    =  1e+2
   diagenesis%kFeNO3    =  1e+3
   diagenesis%kFeSMn    =  1e+2
   diagenesis%kFeSFe    =  1e+1
   diagenesis%kFeSppt   =  4.0E+00
   diagenesis%kTSFe     =  1.00E+01
   diagenesis%kPyrite   =  9.00E+00
   diagenesis%kMnFe     =  1.00E+03
   diagenesis%kTSMn     =  1.00E+01
   diagenesis%kCH4OX    =  1.00E+07
   diagenesis%kCH4SO4   =  2.50E+01
   diagenesis%kSidppt   =  0.007
   diagenesis%kRodppt   =  0.005
   diagenesis%kCalppt   =  0.0
   diagenesis%k(p)O2    =  0.008
   diagenesis%k(p)NO3   =  0.030
   diagenesis%k(p)MnO2  =  10.0
   diagenesis%k(p)FeOH  =  10.0
   diagenesis%k(p)SO4   =  1.000
   diagenesis%kNH4Ads   =  0.00
   diagenesis%kPO4Ads   =  2.00
   diagenesis%X         =  Zn
   diagenesis%Xmk       = 0.06
   diagenesis%Xfl       = 0.065
   diagenesis%Xfm       = 0.0001
   diagenesis%kXSppt    = 1.50E+02
   diagenesis%rxn_mode  =  0
!-- Initial & Boundary Conditions  --!
   diagenesis%ibc2      =  3
   diagenesis%ibbc      =  0
   diagenesis%strtSteady =  0
   diagenesis%fluxscale  =  1.0
   diagenesis%POMVR      =  0.0210
   diagenesis%InitSedDepth  = 100.0
   diagenesis%OMInitMethodL = EX_I
   diagenesis%OM_top    =  1.0
   diagenesis%OM_cf     =  0.6
   diagenesis%OMInitMethodR = LI_I
   diagenesis%OM_min    =  0.9
   diagenesis%InMinDep  = 99.
   diagenesis%OutputUnits =  1
/
